self.addEventListener("push",(t=>{console.log("Push event diterima:",t);let i={};if(t.data)try{i=t.data.json()}catch(a){console.warn("Push event data bukan JSON, gunakan sebagai teks."),i={title:"Pesan Baru",body:t.data.text()}}else i={title:"Notifikasi",body:"Anda punya pesan baru."};const a=i.title||"Story App",n={body:i.body||"Ada cerita baru untuk Anda!",icon:"/icons/favicon.png",badge:"/icons/favicon.png",data:{url:i.url||"/"}};t.waitUntil(self.registration.showNotification(a,n))})),self.addEventListener("notificationclick",(t=>{console.log("Notifikasi diklik:",t.notification),t.notification.close();const i=t.notification.data.url||"/";t.waitUntil(clients.openWindow(i))}));